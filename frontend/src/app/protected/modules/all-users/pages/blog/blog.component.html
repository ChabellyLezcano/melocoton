<app-header></app-header>
<a (click)="onAddClick()" class="text-blue-500 hover:underline mt-4 block text-center">Crear un nuevo artículo</a>
  
<div *ngIf="articles">
  <div
    class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 xl:grid-cols-2 gap-4 m-4"
  >
    <div *ngFor="let article of articles" class="bg-white rounded-lg shadow-md">
      <div class="relative group">
        <div class="flex justify-between items-center">
          <h5 class="text-xl font-semibold m-4">{{ article.title }}</h5>
          <!-- Botón de opciones -->
          <button
            *ngIf="isAdmin"
            class="text-gray-700 font-bold py-2 px-4 rounded"
            (click)="toggleOptions(article)"
          >
            <i class="pi pi-ellipsis-h"></i>
          </button>
          <!-- Menú desplegable (después del botón "Opciones") -->
          <div
            *ngIf="showOptions"
            class="absolute z-10 w-36 py-2 shadow-lg rounded-lg bg-white border border-gray-300"
            style="top: 0rem; right: 2.6rem"
          >
            <button
              class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100"
              (click)="onEditClick(article._id)"
            >
              Editar
            </button>
            <button
              class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100"
              (click)="onAddPhotoClick(article._id)"
            >
              Añadir foto
            </button>
            <button
              class="block w-full text-left px-4 py-2 text-red-700 hover:bg-red-100"
              (click)="deleteArticle(article._id)"
            >
              Borrar
            </button>
          </div>
        </div>
        <img
          [src]="article.photo || 'assets/article_photo.png'"
          class="w-full h-48 object-contain rounded-t-lg"
          alt="Article Image"
        />
      </div>
      <div class="p-4 flex flex-col">
        <p class="text-gray-700 text-sm">
          {{ article.date | date : "dd/MM/yyyy" }}
        </p>
        <p class="text-gray-600 text-md my-2">
          {{ article.text.split(" ").slice(0, 20).join(" ")
          }}{{ article.text.split(" ").length > 20 ? "..." : "" }}
        </p>
        <div class="flex flex-col justify-between mt-4">
            <div class="flex justify-between mb-2 sm:mb-0">
                <div class="flex">
                  <img
                    [src]="article.author?.photo || 'assets/profile.png'"
                    class="w-10 h-10 object-cover rounded-full"
                    alt="Author Photo"
                  />
                  <p class="text-gray-700 text-sm ml-2 mt-2">
                    {{ article.author?.username }}
                  </p>
                </div>
                <button
                  class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded m-2"
                  (click)="onVerClick(article._id)"
                >
                  Ver
                </button>
              </div>
        </div>
      </div>
    </div>
  </div>
</div>
